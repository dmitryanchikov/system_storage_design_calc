<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>{{ t('appTitle') }}</title>
  <link rel="stylesheet" href="styles.css" />
  <!-- Подключение Vue.js через CDN -->
  <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
</head>
<body>
  <div id="app">
    <!-- Шапка приложения -->
    <div class="header">
      <div class="header-inner">
        <div class="header-left">
          <h1>{{ t('appTitle') }}</h1>
        </div>
        <div class="header-right">
          <select v-model="currentLanguage" @change="changeLanguage(false)">
            <option value="ru">Русский</option>
            <option value="en">English</option>
          </select>
        </div>
      </div>
    </div>

    <div class="container">
      <form @submit.prevent="submitForm">
        <h2>{{ t('section1Title') }}</h2>
        <div>
          <label>{{ t('rps') }}:</label>
          <input type="number" v-model.number="formData.rps" required />
        </div>
        <div>
          <label>{{ t('capacity') }}:</label>
          <input type="number" v-model.number="formData.capacity" required />
        </div>
        <div>
          <label>{{ t('throughput') }}:</label>
          <input type="number" v-model.number="formData.throughput" required />
        </div>

        <h2>{{ t('section2Title') }}</h2>
        <div>
          <label>{{ t('ssdNVMe') }}:</label>
          <input type="number" v-model.number="formData.capacityDistribution.ssdNVMe" required />
        </div>
        <div>
          <label>{{ t('ssdSATA') }}:</label>
          <input type="number" v-model.number="formData.capacityDistribution.ssdSATA" required />
        </div>
        <div>
          <label>{{ t('hdd') }}:</label>
          <input type="number" v-model.number="formData.capacityDistribution.hdd" required />
        </div>
        <div>
          <strong>{{ t('sum') }}: {{ capacitySum }}%</strong>
        </div>

        <h2>{{ t('section3Title') }}</h2>
        <div>
          <label>{{ t('ssdNVMe') }}:</label>
          <input type="number" v-model.number="formData.loadDistribution.ssdNVMe" required />
        </div>
        <div>
          <label>{{ t('ssdSATA') }}:</label>
          <input type="number" v-model.number="formData.loadDistribution.ssdSATA" required />
        </div>
        <div>
          <label>{{ t('hdd') }}:</label>
          <input type="number" v-model.number="formData.loadDistribution.hdd" required />
        </div>
        <div>
          <strong>{{ t('sum') }}: {{ loadSum }}%</strong>
        </div>

        <h2>{{ t('section4Title') }}</h2>
        <!-- Параметры для каждого типа диска -->
        <div v-for="(disk, key) in formData.diskParameters" :key="key">
          <h3>{{ diskNames[key] }}</h3>
          <div>
            <label>{{ t('diskCapacity') }}:</label>
            <input type="number" v-model.number="disk.capacity" required />
          </div>
          <div>
            <label>{{ t('diskIOPS') }}:</label>
            <input type="number" v-model.number="disk.iops" required />
          </div>
          <div>
            <label>{{ t('diskThroughput') }}:</label>
            <input type="number" v-model.number="disk.throughput" required />
          </div>
          <div>
            <label>{{ t('diskPrice') }}:</label>
            <input type="number" v-model.number="disk.price" required />
          </div>
        </div>

        <h2>{{ t('section5Title') }}</h2>
        <div>
          <label>{{ t('replicationFactor') }}:</label>
          <input type="number" v-model.number="formData.replicationFactor" required />
        </div>
        <div>
          <label>{{ t('reserveRatio') }}:</label>
          <input type="number" v-model.number="formData.reserveRatio" required />
        </div>

        <button type="submit">{{ t('calculate') }}</button>
      </form>

      <div v-if="error" class="error">
        <p>{{ error }}</p>
      </div>

      <!-- Детальные расчеты -->
      <div v-if="detailedCalculations.length > 0">
        <h2>{{ t('detailedCalculations') }}</h2>
        <pre>{{ detailedCalculations.join('\n') }}</pre>
      </div>

      <!-- Результаты расчета -->
      <div v-if="results">
        <h2>{{ t('calculationResults') }}</h2>
        <table>
          <thead>
            <tr>
              <th>{{ t('parameter') }}</th>
              <th v-for="disk in results.disks">{{ diskNames[disk.diskType] }}</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>{{ t('dataVolume') }}</td>
              <td v-for="disk in results.disks">{{ disk.capacity.toFixed(2) }}</td>
            </tr>
            <tr>
              <td>{{ t('iopsLoad') }}</td>
              <td v-for="disk in results.disks">{{ disk.iopsLoad.toFixed(2) }}</td>
            </tr>
            <tr>
              <td>{{ t('throughputLoad') }}</td>
              <td v-for="disk in results.disks">{{ disk.throughputLoad.toFixed(2) }}</td>
            </tr>
            <tr>
              <td>{{ t('countByCapacity') }}</td>
              <td v-for="disk in results.disks">{{ disk.countByCapacity }}</td>
            </tr>
            <tr>
              <td>{{ t('countByThroughput') }}</td>
              <td v-for="disk in results.disks">{{ disk.countByThroughput }}</td>
            </tr>
            <tr>
              <td>{{ t('countByIOPS') }}</td>
              <td v-for="disk in results.disks">{{ disk.countByIOPS }}</td>
            </tr>
            <tr>
              <td>{{ t('totalDisks') }}</td>
              <td v-for="disk in results.disks">{{ disk.totalDisks }}</td>
            </tr>
            <tr>
              <td>{{ t('replicatedDisks') }}</td>
              <td v-for="disk in results.disks">{{ disk.replicatedDisks }}</td>
            </tr>
            <tr>
              <td>{{ t('cost') }}</td>
              <td v-for="disk in results.disks">{{ disk.cost.toFixed(2) }}</td>
            </tr>
          </tbody>
        </table>
        <h3>{{ t('totalCost') }}: ${{ results.totalCost.toFixed(2) }}</h3>
        <h3>{{ t('totalReplicatedDisks') }}: {{ results.totalReplicatedDisks }}</h3>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
